public User changeUserRole(Long userId, String newRole) {
    User user = userRepository.findById(userId).orElseThrow(...);
    
    // Clear existing roles and assign new one
    user.getRoles().clear();
    user.getRoles().add(Role.valueOf(newRole.toUpperCase()));

    // Set active based on new role
    if (newRole.equalsIgnoreCase("admin") || newRole.equalsIgnoreCase("customer")) {
        user.setActive(false); // Not resolving tickets
    } else {
        user.setActive(true); // Agent available
    }

    return userRepository.save(user);
}



